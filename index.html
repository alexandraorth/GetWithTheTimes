<html>
<head>
	<link rel="stylesheet" href="main_style.css">
	<script src="zepto.js"> </script>

	<title> Get With the Times </title>
</head>
<body>
	<div class="header">
		<p>Get With The Times</p>
	</div> <!-- end of header -->

	<div class="content">
		<img class="article1" alt="title of article">
		<img class="article2" alt="title of article">
		<img class="article3" alt="title of article">
		<img class="article4" alt="title of article">			
		<img class="article5" alt="title of article">
		<img class="article6" alt="title of article">
		<img class="article7" alt="title of article">
		<img class="article8" alt="title of article">

		<script src="d3/d3.v3.min.js"></script>
		<script>
	// Attempts to read .py script to return json


	// $.get("http://api.nytimes.com/svc/mostpopular/v2/mostviewed/all-sections/30.json?api-key=7fffaa70d16f04f4357c4b1d0b873090:17:66946433&callback=?", function(data){
	// 	console.log(data);
	// });

    // $.ajax({
    //         type: "get",
    //         url: "http://api.nytimes.com/svc/mostpopular/v2/mostviewed/all-sections/30.json?api-key=7fffaa70d16f04f4357c4b1d0b873090:17:66946433&callback=?", //webserver config can't read python scripts!
    //         data: {'callFunc':'query'},
    //         datatype:"script",
    //         async: false,
    //         success: function(response) {
    //         // response is string, convert it to json and apply conditions.
    //         console.log(response);
    //     }
    //     })//ajax closed

	var data; // a global
	var imgUrl = [];
	var title = [];

	d3.json("jsonTemp.json", function(json) { // reading from file, to be generated dynamically 
		data = json;
		for (var i = 0; i < data.results.length; i=i+1) {
			if (data.results[i].type === "Article"){ 
				var search = data["results"][i]["media"][0]["media-metadata"];
				console.log(search.length);
				if (search.length >= 5){
					imgUrl.push(data["results"][i]["media"][0]["media-metadata"][5]["url"]); 
					title.push(data["results"][i]["title"]);
				}
				else if (data["results"][i]["media"][1]["media-metadata"].length >= 5){
					imgUrl.push(data["results"][i]["media"][1]["media-metadata"][5]["url"]); 
					title.push(data["results"][i]["title"]);
				}
				else{
					i=i+1;
				}

				for (var j = 0; j < imgUrl.length; j=j+1) {
					d3.select(".article" + (j+1)).attr("src", imgUrl[j]).attr("alt", title[j]);		
					console.log("what are we at " + j);
				};
			}
			else{
				console.log("nay");
			}	
		};
		//asynchronous code here! 
	});

	</script>

</div> <!-- end of content -->

<div class="footer"> 
	<p>This is a footer</p>
</div> <!-- end of footer -->


</body>
</html>
